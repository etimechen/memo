# 安装脚本Section

## [Dirs] section

该可选部分定义了安装程序要创建的其它任何目录，除了用户选择的应用程序目录外，该目录是自动创建的。在主应用程序目录下创建子目录是此section的常用用法。请注意，在使用[Files]section将文件安装到目录之前，无需显式创建目录，因此此section主要用于创建空目录。

这是[Dirs]section的示例：

举例：

```
[Dirs]
Name: "{app}\data"
Name: "{app}\bin"
```

上面的示例将在安装程序创建应用程序目录之后，在应用程序目录下创建两个子目录。

以下是受支持的参数的列表：

### Name（必填）

要创建的目录的名称，通常以目录常数开始。

举例：

```
Name: "{app}\MyDir"
```

### Attribs

指定目录的附加属性。可以包括以下一项或多项：readonly, hidden, system, notcontentindexed。如果未指定此参数，则安装程序不会为目录分配任何特殊属性。如果目录已经存在，则指定的属性将与目录的现有属性合并。

举例：

```
Attribs: hidden system
```

### Permissions

指定要在目录的ACL（访问控制列表）中授予的其他权限。如果您不熟悉ACL或为什么需要更改它们，建议您不要使用此参数，因为滥用它可能会对系统安全性产生负面影响。

为了使此参数生效，目录必须位于支持ACL的分区（例如NTFS）上，并且当前用户必须能够更改目录的权限，否则，不会显示错误信息也不会设置权限。

另外，建议不要使用此参数来授予对包含程序文件的目录的写访问权。例如，授予{app}目录上的“所有人修改”权限，将允许非特权用户篡改应用程序的程序文件；这可能会产生特权升级漏洞。（但是，可以安全地更改应用程序目录的子目录中的权限，该子目录不包含程序文件，例如{app}\data。）

不管目录在安装之前是否存在，都将设置指定的权限。

此参数可以包含一个或多个以空格分隔的值，格式为：

```
<user or group identifier>-<access type>
```

[Dirs]section支持以下访问类型：

#### full

授予“完全控制”权限，与“修改”权限相同（请参见下文），但是还允许指定的用户/组获得目录的所有权和更改权限。谨慎使用；通常，“修改”权限就足够了。

#### modify

授予“修改”权限，该权限允许指定的用户/组读取，执行，创建，修改和删除目录及其子目录中的文件。

#### readexec

授予“读取和执行”权限，该权限允许指定的用户/组读取和执行目录及其子目录中的文件。

```
Permissions: users-modify
```

### Flags

此参数是一组附加选项。通过用空格分隔多个选项。支持以下选项：

#### deleteafterinstall

指示安装程序照常创建目录，但是如果它是空的，一旦安装完成（或中止），便将其删除。当提取脚本的[Run]section中执行的程序所需的临时数据时，此功能很有用。

不会导致安装前已经存在的目录被删除。

#### setntfscompression

指示安装程序在目录上启用NTFS压缩。如果由于某种原因（例如，文件系统不支持压缩）而无法设置压缩，则不会显示错误消息。

如果目录已经存在，则目录中存在的任何文件的压缩状态都不会更改。

#### uninsalwaysuninstall

指示卸载程序始终尝试删除目录（如果目录为空）。通常，卸载程序只会在安装之前不存在的目录下尝试删除该目录。

#### uninsneveruninstall

指示卸载程序不要尝试删除目录。默认情况下，它会删除[Dirs]section中指定的任何空目录。

#### unsetntfscompression

指示安装程序禁用目录上的NTFS压缩。如果由于某种原因（例如，文件系统不支持压缩）而无法设置压缩，则不会显示错误消息。

如果目录已经存在，则目录中存在的任何文件的压缩状态都不会更改。

举例：

```
Flags: uninsneveruninstall
```
